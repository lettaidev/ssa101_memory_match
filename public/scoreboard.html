<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scoreboard - Memory Match</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] } } }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        .bg-grid {
            background-size: 40px 40px;
            background-image: linear-gradient(to right, rgba(203,213,225,0.4) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(203,213,225,0.4) 1px, transparent 1px);
            mask-image: linear-gradient(to bottom, black 40%, transparent 100%);
        }
        .glass-card { backdrop-filter: blur(12px); }
    </style>
</head>
<body class="min-h-screen antialiased font-sans bg-slate-50 text-slate-900">
    <div class="fixed inset-0 z-0 bg-grid pointer-events-none"></div>

    <nav class="sticky top-0 z-50 w-full border-b border-slate-200 bg-white/80 backdrop-blur-md">
        <div class="max-w-5xl mx-auto px-6 h-14 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="h-6 w-6 rounded-md bg-gradient-to-tr from-emerald-500 to-sky-500 flex items-center justify-center text-[0.6rem] font-semibold shadow-lg shadow-emerald-500/20">
                    <span class="text-white">MM</span>
                </div>
                <span class="text-sm font-semibold tracking-tight text-slate-900">Scoreboard</span>
            </div>
            <div class="flex items-center gap-3">
                <a href="/" class="text-xs font-medium text-slate-500 hover:text-emerald-600">Play</a>
            </div>
        </div>
    </nav>

    <main class="relative z-10 flex flex-col items-center w-full py-10 px-4">
        <div class="w-full max-w-2xl">

            <div class="text-center mb-8 space-y-2">
                <div class="inline-flex items-center gap-1.5 rounded-full border border-emerald-500/20 bg-emerald-500/10 px-2.5 py-0.5 text-[0.65rem] text-emerald-600 font-medium">
                    <span class="h-1.5 w-1.5 rounded-full bg-emerald-500 animate-pulse"></span>
                    <span>Live Scoreboard</span>
                </div>
                <h1 class="text-2xl sm:text-3xl font-semibold tracking-tight text-slate-900">Team Rankings</h1>
                <p id="sb-timer" class="text-sm text-slate-500">Waiting for game...</p>
            </div>

            <!-- Scoreboard table -->
            <div class="glass-card rounded-2xl border border-slate-200 bg-white shadow-xl overflow-hidden">
                <div class="grid grid-cols-4 gap-px bg-slate-100 border-b border-slate-200">
                    <div class="p-3 bg-white text-xs font-semibold uppercase tracking-wider text-slate-400">Rank</div>
                    <div class="p-3 bg-white text-xs font-semibold uppercase tracking-wider text-slate-400">Team</div>
                    <div class="p-3 bg-white text-xs font-semibold uppercase tracking-wider text-slate-400 text-center">Matches</div>
                    <div class="p-3 bg-white text-xs font-semibold uppercase tracking-wider text-slate-400 text-right">Score</div>
                </div>
                <div id="sb-body" class="divide-y divide-slate-100">
                    <div class="p-6 text-center text-sm text-slate-400">No teams yet</div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const socket = io();

        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        socket.on('scoreboard', (teams) => {
            const body = document.getElementById('sb-body');
            if (!teams || teams.length === 0) {
                body.innerHTML = '<div class="p-6 text-center text-sm text-slate-400">No teams yet</div>';
                return;
            }

            body.innerHTML = teams.map((t, i) => {
                const rankColors = ['text-amber-500', 'text-slate-400', 'text-orange-400'];
                const rankColor = rankColors[i] || 'text-slate-300';
                return `
                <div class="grid grid-cols-4 gap-px items-center ${i === 0 ? 'bg-emerald-50/50' : ''}">
                    <div class="p-3 font-bold ${rankColor} text-lg">#${i + 1}</div>
                    <div class="p-3 font-semibold text-slate-800 text-sm">${escapeHtml(t.teamName)}</div>
                    <div class="p-3 text-center text-sm text-slate-600">${t.matchesFound}</div>
                    <div class="p-3 text-right font-bold text-emerald-600 text-lg">${t.score}</div>
                </div>`;
            }).join('');
        });

        socket.on('timer', ({ remainingTime }) => {
            const mins = Math.floor(remainingTime / 60);
            const secs = remainingTime % 60;
            document.getElementById('sb-timer').textContent = `Time remaining: ${mins}:${secs.toString().padStart(2, '0')}`;
        });

        socket.on('gameEnded', () => {
            document.getElementById('sb-timer').textContent = 'Game Over!';
        });

        socket.on('gameReset', () => {
            document.getElementById('sb-timer').textContent = 'Waiting for game...';
        });

        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons({ attrs: { 'stroke-width': 1.5 } });
        });
    </script>
</body>
</html>
